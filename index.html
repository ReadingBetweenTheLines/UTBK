<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UTBK SNBT English Literacy: Master Course & Simulation</title>
    <style>
        :root {
            --primary: #2563eb;
            --primary-dark: #1e40af;
            --secondary: #64748b;
            --accent: #f59e0b;
            --bg: #f8fafc;
            --card-bg: #ffffff;
            --text: #1e293b;
            --border: #e2e8f0;
            --success-bg: #dcfce7;
            --success-text: #166534;
            --error-bg: #fee2e2;
            --error-text: #991b1b;
        }

        * { box-sizing: border-box; }

        body {
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0;
            padding: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* --- SHARED STYLES --- */
        h1, h2, h3 { color: var(--text); margin-top: 0; }
        .btn {
            padding: 12px 28px;
            border-radius: 8px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            border: none;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        .btn-primary { background: var(--primary); color: white; box-shadow: 0 4px 6px -1px rgba(37, 99, 235, 0.2); }
        .btn-primary:hover { background: var(--primary-dark); transform: translateY(-1px); }
        
        .badge {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.85em;
            font-weight: bold;
            text-transform: uppercase;
        }

        /* --- VIEW 1: LEARNING MATERIAL --- */
        #learning-view {
            flex: 1;
            overflow-y: auto;
            padding: 40px 20px;
            max-width: 1000px;
            margin: 0 auto;
            width: 100%;
        }

        .hero-section {
            text-align: center;
            margin-bottom: 50px;
            padding: 40px;
            background: white;
            border-radius: 16px;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05);
            border: 1px solid var(--border);
        }

        .hero-title { font-size: 2.5rem; color: var(--primary); margin-bottom: 10px; }
        .hero-subtitle { font-size: 1.2rem; color: var(--secondary); max-width: 600px; margin: 0 auto; }

        .module-card {
            background: white;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid var(--border);
            box-shadow: 0 2px 4px rgba(0,0,0,0.02);
        }

        .module-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 2px solid var(--bg);
            padding-bottom: 15px;
        }

        .module-number {
            background: var(--primary);
            color: white;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            margin-right: 15px;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        .comparison-table th, .comparison-table td {
            padding: 12px;
            border: 1px solid var(--border);
            text-align: left;
        }
        .comparison-table th { background: var(--bg); color: var(--secondary); }

        .mechanic-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        .mechanic-box {
            background: var(--bg);
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid var(--primary);
        }

        /* Traffic Lights */
        .traffic-light {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        .light-box {
            flex: 1;
            min-width: 200px;
            padding: 15px;
            border-radius: 8px;
            color: white;
        }
        .light-red { background: #ef4444; }
        .light-yellow { background: #f59e0b; color: black; }
        .light-green { background: #10b981; }

        /* --- VIEW 2: QUIZ APP (Initially Hidden) --- */
        #quiz-view {
            display: none;
            height: 100vh;
            flex-direction: column;
        }

        header.quiz-header {
            background: var(--card-bg);
            padding: 15px 20px;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }

        main.quiz-main {
            flex: 1;
            display: flex;
            overflow: hidden;
            padding: 20px;
            gap: 20px;
            max-width: 1400px;
            margin: 0 auto;
            width: 100%;
        }

        /* Panels */
        .passage-panel {
            flex: 1;
            background: var(--card-bg);
            padding: 25px;
            border-radius: 12px;
            border: 1px solid var(--border);
            overflow-y: auto;
            line-height: 1.8;
            font-family: 'Georgia', serif;
            font-size: 1.05rem;
            color: #334155;
        }

        .question-panel {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: var(--card-bg);
            padding: 25px;
            border-radius: 12px;
            border: 1px solid var(--border);
            overflow-y: auto;
        }

        .passage-title {
            font-weight: bold;
            color: var(--secondary);
            text-transform: uppercase;
            font-size: 0.85rem;
            margin-bottom: 15px;
            border-bottom: 2px solid var(--primary);
            display: inline-block;
            padding-bottom: 5px;
        }

        /* Options */
        .option-card {
            display: flex;
            padding: 15px;
            margin-bottom: 12px;
            border: 2px solid var(--border);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            align-items: flex-start;
        }
        .option-card:hover { border-color: var(--primary); background-color: #eff6ff; }
        .option-card.selected { border-color: var(--primary); background-color: #eff6ff; box-shadow: 0 0 0 1px var(--primary); }
        .option-card input { display: none; }
        .option-marker { min-width: 30px; font-weight: bold; color: var(--secondary); }

        /* Revealed States */
        .revealed .option-card { pointer-events: none; }
        .revealed .option-card.correct { background-color: var(--success-bg); border-color: var(--success-text); color: var(--success-text); }
        .revealed .option-card.wrong { background-color: var(--error-bg); border-color: var(--error-text); color: var(--error-text); opacity: 0.8; }

        .feedback-box {
            margin-top: 25px;
            padding: 20px;
            border-radius: 8px;
            background: #f0fdf4;
            border: 1px solid #bbf7d0;
            display: none;
            animation: fadeIn 0.3s ease-in;
        }

        .controls {
            padding: 20px;
            background: var(--card-bg);
            border-top: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
        }

        /* Mobile */
        @media (max-width: 768px) {
            main.quiz-main { flex-direction: column; overflow-y: auto; }
            .passage-panel { max-height: 200px; border-bottom: 4px solid var(--border); }
        }

        /* Modal */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5); display: none;
            justify-content: center; align-items: center; z-index: 100;
        }
        .modal { background: white; padding: 40px; border-radius: 12px; text-align: center; max-width: 500px; }
        .score-circle {
            width: 120px; height: 120px; background: var(--primary); color: white;
            border-radius: 50%; display: flex; justify-content: center; align-items: center;
            font-size: 2.5rem; font-weight: bold; margin: 0 auto 20px;
        }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

    <!-- ==================== VIEW 1: LEARNING MATERIALS ==================== -->
    <div id="learning-view">
        <div class="hero-section">
            <h1 class="hero-title">Literasi Bahasa Inggris UTBK SNBT</h1>
            <p class="hero-subtitle">Kuasai logika, mekanisme, dan strategi yang dibutuhkan untuk sukses di ujian 2025.</p>
        </div>

        <!-- Module 1 -->
        <div class="module-card">
            <div class="module-header">
                <div class="module-number">1</div>
                <h2>Filosofi Utama</h2>
            </div>
            <p>UTBK bukanlah tes kosakata; ini adalah <strong>tes penalaran</strong>. Berhentilah membaca untuk mencari "fakta" dan mulailah membaca untuk memahami "struktur".</p>
            <table class="comparison-table">
                <thead>
                    <tr><th>Fitur</th><th>Ujian Sekolah</th><th>UTBK SNBT</th></tr>
                </thead>
                <tbody>
                    <tr><td><strong>Tujuan</strong></td><td>Hafalan & Tata Bahasa</td><td>Logika & Sintesis</td></tr>
                    <tr><td><strong>Pertanyaan</strong></td><td>"Apa arti kata ini?"</td><td>"Apa yang tersirat dari penulis?"</td></tr>
                    <tr><td><strong>Kecepatan</strong></td><td>Santai (~2 mnt/soal)</td><td>Ekstrem (~1 mnt/soal)</td></tr>
                </tbody>
            </table>
        </div>

        <!-- Module 2 -->
        <div class="module-card">
            <div class="module-header">
                <div class="module-number">2</div>
                <h2>4 Mekanisme Inti</h2>
            </div>
            <p>Pertanyaan berbeda membutuhkan "pola pikir" yang berbeda. Gunakan mekanisme yang tepat untuk soal yang tepat.</p>
            <div class="mechanic-grid">
                <div class="mechanic-box">
                    <h3>1. Kecocokan Literal</h3>
                    <p><strong>Mekanisme:</strong> Cari & Tukar.</p>
                    <p>Cari kalimatnya, tukar dengan sinonim. Jika tidak tertulis, berarti salah.</p>
                </div>
                <div class="mechanic-box">
                    <h3>2. Teka-teki Logika</h3>
                    <p><strong>Mekanisme:</strong> Hubungan yang Hilang.</p>
                    <p>Gabungkan Premis A + Premis B untuk menemukan Kesimpulan C.</p>
                </div>
                <div class="mechanic-box">
                    <h3>3. Gambaran Besar</h3>
                    <p><strong>Mekanisme:</strong> Payung.</p>
                    <p>Apakah jawaban mencakup SEMUA paragraf? Hindari jawaban "Benar tapi Terlalu Spesifik".</p>
                </div>
                <div class="mechanic-box">
                    <h3>4. Hubungan</h3>
                    <p><strong>Mekanisme:</strong> Analisis Fungsi.</p>
                    <p>Abaikan <em>apa</em> yang dikatakan teks, fokus pada <em>apa fungsinya</em> (Mengontraskan? Mendukung?).</p>
                </div>
            </div>
        </div>

        <!-- Module 3 -->
        <div class="module-card">
            <div class="module-header">
                <div class="module-number">3</div>
                <h2>Panduan Bertahan: Lampu Lalu Lintas</h2>
            </div>
            <p>Tidak tahu kosakatanya? Fokus pada <strong>Kata Penghubung</strong> (Penunjuk Arah) untuk memetakan logikanya.</p>
            <div class="traffic-light">
                <div class="light-box light-red">
                    <h3>BERHENTI (Kontras)</h3>
                    <p><em>However, Although, But, Yet, Despite</em></p>
                    <p>Arah berubah di sini. Jawaban sering tersembunyi di sini.</p>
                </div>
                <div class="light-box light-green">
                    <h3>JALAN (Sebab/Akibat)</h3>
                    <p><em>Therefore, Consequently, Thus, Because</em></p>
                    <p>Penghubung antara Sebab dan Akibat.</p>
                </div>
                <div class="light-box light-yellow">
                    <h3>PELAN-PELAN (Penambahan)</h3>
                    <p><em>Moreover, Furthermore, Also</em></p>
                    <p>Hanya info tambahan. Baca sekilas jika sudah paham kalimat sebelumnya.</p>
                </div>
            </div>
        </div>

        <div style="text-align: center; margin-top: 40px;">
            <button class="btn btn-primary" style="font-size: 1.5rem; padding: 20px 40px;" onclick="startQuiz()">
                Mulai Simulasi Latihan
            </button>
            <p style="color: var(--secondary); margin-top: 10px;">20 Soal | Umpan Balik Langsung | Analisis Logika</p>
        </div>
    </div>

    <!-- ==================== VIEW 2: QUIZ APP ==================== -->
    <div id="quiz-view">
        <header class="quiz-header">
            <div>
                <h1 style="font-size: 1.2rem; color: var(--primary); margin:0;">UTBK Simulation</h1>
                <span style="font-size: 0.85rem; color: var(--secondary); cursor: pointer; text-decoration: underline;" onclick="returnToLearn()">← Kembali ke Materi</span>
            </div>
            <div style="font-weight: bold; color: var(--secondary);" id="progress-text">Question 1 of 20</div>
        </header>

        <main class="quiz-main">
            <div class="passage-panel" id="passage-display"></div>
            <div class="question-panel" id="question-display"></div>
        </main>

        <div class="controls">
            <button class="btn" style="background:#e2e8f0;" id="btn-prev" onclick="prevQuestion()">Previous</button>
            <button class="btn btn-primary" id="btn-action" onclick="handleAction()">Check Answer</button>
        </div>
    </div>

    <!-- Results Modal -->
    <div class="modal-overlay" id="score-modal">
        <div class="modal">
            <h2>Sesi Selesai!</h2>
            <div class="score-circle" id="final-score">0</div>
            <p id="final-msg">Kerja bagus!</p>
            <div style="display: flex; gap: 10px; justify-content: center;">
                <button class="btn" style="background: #e2e8f0;" onclick="returnToLearn()">Review Materi</button>
                <button class="btn btn-primary" onclick="restartQuiz()">Ulangi Kuis</button>
            </div>
        </div>
    </div>

<script>
    /* ================= DATA SOURCE ================= */
    const rawData = [
        {
            text: "Although the rapid integration of Artificial Intelligence (AI) in creative industries has sparked fears of mass unemployment, historical precedent suggests a more nuanced outcome. During the Industrial Revolution, mechanization did not permanently reduce the total number of jobs; rather, it shifted the workforce from manual labor to supervisory and maintenance roles. Similarly, AI tools like generative design software are likely to commoditize low-skill repetition while placing a premium on high-level curation and strategic decision-making. Therefore, the true threat lies not in the technology itself, but in the educational lag: a workforce trained for rote execution will indeed be obsolete, while those taught to synthesize and direct AI outputs will thrive.",
            questions: [
                { q: "What is the author's primary purpose in mentioning the Industrial Revolution?", options: [{t:"To prove that AI technology is identical to steam-powered machinery.", c:false}, {t:"To provide a historical analogy that challenges the fear of total job loss.", c:true}, {t:"To argue that the workforce should return to manual labor roles.", c:false}, {t:"To suggest that the economic impact of AI will be less severe than industrialization.", c:false}, {t:"To highlight the suffering of workers during the 19th century.", c:false}], exp: "<strong>Mechanic: Analogy/Function.</strong> The author uses the Industrial Revolution as a parallel case to support the argument that jobs shift rather than disappear." },
                { q: "Which of the following creates the most logical inference regarding 'educational lag'?", options: [{t:"Schools are currently focusing too much on strategic decision-making.", c:false}, {t:"The current education system prioritizes rote execution over synthesis skills.", c:true}, {t:"AI technology is developing slower than educational curriculums.", c:false}, {t:"Maintenance roles will require less education than creative roles.", c:false}, {t:"The government has banned AI tools in educational institutions.", c:false}], exp: "<strong>Mechanic: Inference.</strong> If a workforce trained for 'rote execution' will be obsolete due to the 'lag', it implies the current system is still teaching rote execution." },
                { q: "The author implies that in the future, the value of a human worker will depend primarily on:", options: [{t:"Their ability to perform repetitive tasks faster than AI.", c:false}, {t:"Their technical skill in programming complex algorithms.", c:false}, {t:"Their capacity to judge, curate, and direct machine-generated output.", c:true}, {t:"Their willingness to accept lower wages to compete with software.", c:false}, {t:"Their rejection of AI tools in favor of traditional methods.", c:false}], exp: "<strong>Mechanic: Detail/Synthesis.</strong> The text states AI places a premium on 'high-level curation and strategic decision-making'." },
                { q: "Which finding, if true, would most WEAKEN the author's argument?", options: [{t:"AI can now perform strategic decision-making better than humans.", c:true}, {t:"Many graphic designers have already lost freelance clients to AI.", c:false}, {t:"The cost of AI software is increasing rapidly.", c:false}, {t:"Schools have started introducing basic coding classes.", c:false}, {t:"The Industrial Revolution caused short-term poverty before long-term growth.", c:false}], exp: "<strong>Mechanic: Weakener.</strong> The author argues humans will thrive by doing the 'strategy' while AI does the 'repetition'. If AI takes over the strategy too, the human role disappears." }
            ]
        },
        {
            text: "The concept of 'rewilding' conservation—restoring large areas of land to their natural uncultivated state—often faces resistance from agricultural communities. Farmers argue that reintroducing apex predators like wolves endangers livestock and threatens rural livelihoods. However, proponents contend that the ecological benefits, such as natural pest control and soil regeneration, ultimately boost agricultural productivity in surrounding areas. Furthermore, the burgeoning eco-tourism industry centered on these rewilded zones can offer a more stable income stream than traditional farming, which is increasingly vulnerable to climate volatility. Thus, the conflict is not necessarily between economy and ecology, but between short-term tradition and long-term adaptation.",
            questions: [
                { q: "What is the relationship between the two bolded arguments in the text?", options: [{t:"The second argument completely invalidates the factual accuracy of the first.", c:false}, {t:"The first argument focuses on economic risks, while the second reframes the issue as an economic opportunity.", c:true}, {t:"The first argument is a specific example of the general principle stated in the second.", c:false}, {t:"Both arguments agree that rewilding is harmful to rural communities.", c:false}, {t:"The second argument supports the farmers' fear of apex predators.", c:false}], exp: "<strong>Mechanic: Relationship.</strong> The text shifts from the farmers' view (Risk) to the proponents' view (Benefit/Opportunity), reframing the economic narrative." },
                { q: "The author suggests that traditional farming is:", options: [{t:"The most stable source of income for rural areas.", c:false}, {t:"Environmentally superior to eco-tourism.", c:false}, {t:"Becoming riskier due to unpredictable weather patterns.", c:true}, {t:"Essential for the survival of apex predators.", c:false}, {t:"No longer necessary for food production.", c:false}], exp: "<strong>Mechanic: Detail/Synonym.</strong> The text says traditional farming is 'increasingly vulnerable to climate volatility'." },
                { q: "Which assumption underlies the proponents' argument about eco-tourism?", options: [{t:"Tourists are unwilling to visit areas with dangerous predators.", c:false}, {t:"Farmers can easily transition their skills from agriculture to hospitality.", c:false}, {t:"The revenue from tourists is sufficient to offset potential livestock losses.", c:true}, {t:"Rewilding requires the complete removal of all human settlements.", c:false}, {t:"Wolves will never attack livestock if tourists are present.", c:false}], exp: "<strong>Mechanic: Assumption.</strong> For eco-tourism to be a 'more stable income stream' that justifies the risk, it must generate enough money to cover the downsides." },
                { q: "The phrase 'short-term tradition and long-term adaptation' refers to the conflict between:", options: [{t:"Hunting wolves vs. protecting wolves.", c:false}, {t:"Urban city dwellers vs. rural farmers.", c:false}, {t:"Maintaining current farming practices vs. evolving economically.", c:true}, {t:"Government regulations vs. local freedom.", c:false}, {t:"Scientific facts vs. superstitious beliefs.", c:false}], exp: "<strong>Mechanic: Interpretation.</strong> Tradition = farming as it is now. Adaptation = shifting to eco-tourism and rewilding." }
            ]
        },
        {
            text: "While placebo effects are often dismissed as 'imaginary' in clinical trials, neurobiology reveals they trigger genuine physiological changes. When a patient believes a treatment will work, the brain releases endorphins and dopamine, chemicals that actively reduce pain signals. This suggests that the ritual of medicine—the doctor's white coat, the prescription, the pill swallowing—is not merely theater but a catalytic component of healing. Consequently, some bioethicists argue that 'open-label placebos' (telling patients the pill is fake but explaining the mechanism) could be ethically prescribed, harnessing the mind's power without deception.",
            questions: [
                { q: "The passage implies that the 'ritual of medicine' functions as:", options: [{t:"A deceptive practice to charge patients more money.", c:false}, {t:"A psychological trigger that initiates biological healing processes.", c:true}, {t:"A necessary administrative step in hospitals.", c:false}, {t:"A method to distract patients from the side effects of drugs.", c:false}, {t:"A outdated tradition that should be removed.", c:false}], exp: "<strong>Mechanic: Inference.</strong> The text calls the ritual a 'catalytic component' that triggers chemical release." },
                { q: "Why does the author mention 'endorphins and dopamine'?", options: [{t:"To list the side effects of taking too many placebos.", c:false}, {t:"To prove that the placebo effect has a tangible physical basis.", c:true}, {t:"To explain why patients become addicted to medication.", c:false}, {t:"To contrast with the chemicals found in real medicine.", c:false}, {t:"To show that pain is entirely an illusion.", c:false}], exp: "<strong>Mechanic: Purpose.</strong> These chemicals are cited as evidence that the effect is 'genuine' and 'physiological', not just imaginary." },
                { q: "What is an 'open-label placebo' according to the text?", options: [{t:"A placebo that contains a small amount of active medicine.", c:false}, {t:"A treatment where the patient is unaware they are taking sugar pills.", c:false}, {t:"A treatment where the patient knows the pill is inert but expects results.", c:true}, {t:"A generic drug sold without a brand name.", c:false}, {t:"A dangerous drug that is still in the testing phase.", c:false}], exp: "<strong>Mechanic: Definition.</strong> The text defines it as 'telling patients the pill is fake but explaining the mechanism'." },
                { q: "Which word best describes the author's attitude toward the placebo effect?", options: [{t:"Dismissive and skeptical.", c:false}, {t:"Scientific and appreciative.", c:true}, {t:"Confused and tentative.", c:false}, {t:"Critical and ethical.", c:false}, {t:"Indifferent and neutral.", c:false}], exp: "<strong>Mechanic: Tone.</strong> The author uses positive terms like 'genuine physiological changes', 'catalytic component', and 'harnessing the mind's power'." }
            ]
        },
        {
            text: "The paradox of modern connectivity is that while social media platforms promise to bridge distances, they often foster 'echo chambers' that deepen societal divisions. Algorithms are designed to maximize engagement, which is most easily achieved by feeding users content that reinforces their pre-existing beliefs. This confirmation bias insulates individuals from opposing viewpoints, causing intellectual stagnation. Paradoxically, the more connected we become digitally, the more fragmented we become intellectually. Meaningful discourse, which requires the friction of disagreement, is replaced by the comfort of validation.",
            questions: [
                { q: "The term 'friction of disagreement' suggests that:", options: [{t:"Disagreement causes unnecessary stress and should be avoided.", c:false}, {t:"Conflict is a destructive force in society.", c:false}, {t:"Clashing ideas are necessary for productive and meaningful discussion.", c:true}, {t:"Social media algorithms create too much arguing.", c:false}, {t:"People enjoy fighting online more than agreeing.", c:false}], exp: "<strong>Mechanic: Metaphor/Inference.</strong> 'Friction' here is positive; it is required for 'meaningful discourse', implying growth comes from challenge." },
                { q: "According to the text, why do algorithms prioritize content that reinforces beliefs?", options: [{t:"To educate users about correct information.", c:false}, {t:"To maximize user engagement and time on the platform.", c:true}, {t:"To prevent users from getting angry.", c:false}, {t:"To follow government censorship laws.", c:false}, {t:"To promote diverse viewpoints.", c:false}], exp: "<strong>Mechanic: Literal/Causal.</strong> Text says: 'Algorithms are designed to maximize engagement, which is most easily achieved by...'" },
                { q: "Which situation is most analogous to the 'echo chamber' described?", options: [{t:"A library that contains books from every country in the world.", c:false}, {t:"A person who only watches news channels that agree with their political party.", c:true}, {t:"A debate club where members must argue for the opposite side.", c:false}, {t:"A scientist conducting an experiment to disprove their own theory.", c:false}, {t:"A radio that picks up static interference from other stations.", c:false}], exp: "<strong>Mechanic: Analogy.</strong> The echo chamber reinforces existing beliefs. Watching only agreeing news is the exact same mechanism." },
                { q: "What is the 'paradox' mentioned in the text?", options: [{t:"Technology is expensive but makes us poor.", c:false}, {t:"We have more friends but feel lonelier.", c:false}, {t:"Increased technical connectivity leads to increased intellectual separation.", c:true}, {t:"Algorithms are smart but make mistakes.", c:false}, {t:"Social media is free but takes our data.", c:false}], exp: "<strong>Mechanic: Main Idea.</strong> 'The more connected we become digitally, the more fragmented we become intellectually.'" }
            ]
        },
        {
            text: "In urban planning, 'hostile architecture' refers to design elements intentionally intended to restrict behavior, such as benches with armrests to prevent sleeping or spikes on ledges to deter sitting. While officials defend these measures as necessary for maintaining order and sanitation, critics view them as a silent war on the homeless. This design philosophy prioritizes the aesthetic sterility of public spaces over their humanitarian function. By physically designing exclusion into the built environment, cities effectively criminalize the very existence of their most vulnerable citizens without passing a single law.",
            questions: [
                { q: "What is the main function of the phrase 'without passing a single law'?", options: [{t:"To praise the efficiency of city planners.", c:false}, {t:"To show that the legal system is broken.", c:false}, {t:"To highlight how physical design can enforce social policy implicitly.", c:true}, {t:"To suggest that homeless people are breaking laws.", c:false}, {t:"To argue that we need more laws to protect public spaces.", c:false}], exp: "<strong>Mechanic: Function.</strong> It emphasizes the insidious nature of the architecture—it achieves a legal result (exclusion) through physical means." },
                { q: "Based on the text, proponents of hostile architecture would likely argue that:", options: [{t:"It is designed to hurt the homeless.", c:false}, {t:"It is necessary to keep public spaces clean and orderly.", c:true}, {t:"It is a waste of taxpayer money.", c:false}, {t:"It improves the comfort of benches.", c:false}, {t:"It encourages people to sleep in parks.", c:false}], exp: "<strong>Mechanic: Inference (Opposing View).</strong> The text says 'officials defend these measures as necessary for maintaining order and sanitation'." },
                { q: "The author uses the term 'aesthetic sterility' to imply that:", options: [{t:"The city is clean and free of germs.", c:false}, {t:"The design is beautiful but lifeless and unwelcoming.", c:true}, {t:"The architecture is modern and futuristic.", c:false}, {t:"The public spaces are poorly maintained.", c:false}, {t:"The city has no budget for decoration.", c:false}], exp: "<strong>Mechanic: Vocab in Context.</strong> Sterility usually means clean, but here it implies 'lifeless' or 'lacking humanity'." },
                { q: "Which of the following is an example of 'hostile architecture' based on the definition?", options: [{t:"A park with free drinking water fountains.", c:false}, {t:"A bus stop with slanted seats that are impossible to lie on.", c:true}, {t:"A statue of a famous historical figure.", c:false}, {t:"A sidewalk with wheelchair ramps.", c:false}, {t:"A playground with soft rubber flooring.", c:false}], exp: "<strong>Mechanic: Application.</strong> Slanted seats restrict the behavior of sleeping/lying down, fitting the definition." }
            ]
        }
    ];

    /* ================= APP LOGIC ================= */
    let flatQuestions = [];
    let currentIndex = 0;
    let userAnswers = new Array(20).fill(null);
    let questionStatus = new Array(20).fill('unanswered');

    function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
    }

    function initQuizData() {
        flatQuestions = [];
        currentIndex = 0;
        userAnswers = new Array(20).fill(null);
        questionStatus = new Array(20).fill('unanswered');

        rawData.forEach((section, sIndex) => {
            section.questions.forEach((q, qIndex) => {
                let shuffledOptions = q.options.map((opt, i) => ({ ...opt, originalIndex: i }));
                shuffleArray(shuffledOptions);
                flatQuestions.push({
                    text: section.text,
                    passageTitle: `Passage ${sIndex + 1}`,
                    questionText: q.q,
                    options: shuffledOptions,
                    explanation: q.exp
                });
            });
        });
    }

    /* --- View Navigation --- */
    function startQuiz() {
        initQuizData();
        document.getElementById('learning-view').style.display = 'none';
        document.getElementById('quiz-view').style.display = 'flex';
        renderSlide();
    }

    function returnToLearn() {
        document.getElementById('score-modal').style.display = 'none';
        document.getElementById('quiz-view').style.display = 'none';
        document.getElementById('learning-view').style.display = 'block';
    }

    function restartQuiz() {
        document.getElementById('score-modal').style.display = 'none';
        startQuiz();
    }

    /* --- Quiz Rendering --- */
    function renderSlide() {
        const qData = flatQuestions[currentIndex];
        const status = questionStatus[currentIndex];
        const hasSelected = userAnswers[currentIndex] !== null;

        document.getElementById('progress-text').innerText = `Question ${currentIndex + 1} of ${flatQuestions.length}`;
        
        document.getElementById('passage-display').innerHTML = `
            <div class="passage-title">${qData.passageTitle}</div>
            <div>${qData.text}</div>
        `;

        const containerClass = status === 'revealed' ? 'options-container revealed' : 'options-container';
        let optionsHtml = '';
        const labels = ['A', 'B', 'C', 'D', 'E'];
        
        qData.options.forEach((opt, idx) => {
            const isSelected = (userAnswers[currentIndex] === idx);
            let extraClass = '';
            
            if (status === 'revealed') {
                if (opt.c) extraClass += ' correct';
                if (isSelected && !opt.c) extraClass += ' wrong';
            } else {
                if (isSelected) extraClass += ' selected';
            }

            const clickHandler = status === 'revealed' ? '' : `onclick="selectOption(${idx})"`;

            optionsHtml += `
                <label class="option-card${extraClass}" ${clickHandler}>
                    <span class="option-marker">${labels[idx]}.</span>
                    <span>${opt.t}</span>
                    <input type="radio" name="qOption" value="${idx}" ${isSelected ? 'checked' : ''} ${status === 'revealed' ? 'disabled' : ''}>
                </label>
            `;
        });

        const expDisplay = status === 'revealed' ? 'block' : 'none';
        document.getElementById('question-display').innerHTML = `
            <div class="question-text">${qData.questionText}</div>
            <div class="${containerClass}">${optionsHtml}</div>
            <div class="feedback-box" style="display: ${expDisplay}">
                <strong>Explanation:</strong><br>${qData.explanation}
            </div>
        `;

        // Buttons
        const btnAction = document.getElementById('btn-action');
        const btnPrev = document.getElementById('btn-prev');

        btnPrev.disabled = (currentIndex === 0);

        if (status === 'revealed') {
            if (currentIndex === flatQuestions.length - 1) {
                btnAction.innerHTML = "Finish Session";
                btnAction.onclick = finishQuiz;
            } else {
                btnAction.innerHTML = "Next Question →";
                btnAction.onclick = nextQuestion;
            }
        } else {
            btnAction.innerHTML = "Check Answer";
            btnAction.disabled = !hasSelected; 
            btnAction.onclick = checkAnswer;
        }
    }

    /* --- Quiz Interaction --- */
    function selectOption(idx) {
        if (questionStatus[currentIndex] === 'revealed') return;
        userAnswers[currentIndex] = idx;
        renderSlide(); 
    }

    function checkAnswer() {
        if (userAnswers[currentIndex] === null) return;
        questionStatus[currentIndex] = 'revealed';
        renderSlide();
    }

    function nextQuestion() {
        if (currentIndex < flatQuestions.length - 1) {
            currentIndex++;
            renderSlide();
        }
    }

    function prevQuestion() {
        if (currentIndex > 0) {
            currentIndex--;
            renderSlide();
        }
    }

    function finishQuiz() {
        let score = 0;
        flatQuestions.forEach((q, idx) => {
            const userChoiceIdx = userAnswers[idx];
            if (userChoiceIdx !== null && q.options[userChoiceIdx].c === true) score++;
        });

        document.getElementById('final-score').innerText = `${score}/20`;
        const percentage = (score/20)*100;
        let msg = "Keep practicing!";
        if (percentage >= 80) msg = "Excellent! You are ready for UTBK.";
        else if (percentage >= 50) msg = "Good start, review the concepts.";
        document.getElementById('final-msg').innerText = msg;
        document.getElementById('score-modal').style.display = 'flex';
    }

</script>
</body>
</html>